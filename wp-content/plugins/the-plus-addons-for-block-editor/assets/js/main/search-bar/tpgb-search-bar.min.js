function tp_loadmore_ajax(e,a,l,i){let o=i.querySelector(".post-load-more"),c=i.querySelector(".tpgb-search-slider"),p=i.querySelector(".tpgb-search-pagina");p&&e&&(p.innerHTML=e.loadmore_page),o&&o.addEventListener("click",function(e){var t=Number(this.dataset.page),s=Number(t+1),t=i.querySelectorAll(".tpgb-ser-item");a.offset=t.length,a.loadNumpost=l.loadnumber,jQuery.ajax({url:tpgb_config&&tpgb_config.ajax_url?tpgb_config.ajax_url:tpgb_load.ajaxUrl,method:"post",async:!0,data:a,beforeSend:function(){o.textContent=l.loadingtxt},success:function(e){o.textContent=l.loadbtntxt;let t=e.data.posts,a=e.data.total_count,r=null,n="";for(r in t)n+=t[r];if(c.innerHTML+=n,o.setAttribute("data-page",s),p){let e=p.querySelector(".tpgb-load-number");e.textContent=s}i.querySelectorAll(".tpgb-ser-item").length==a&&(o.classList.add("tp-hide"),o.parentNode.innerHTML+='<div class="tpgb-post-loaded">'+l.loadedtxt+"</div>")},complete:function(){}})})}function tp_lazymore_ajax(r,l,i){let o=i.querySelector(".post-lazy-load"),c=i.querySelector(".tpgb-search-slider");i.querySelectorAll(".tpgb-search-pagina");function n(){g.innerWidth,s=g.innerHeight,p=document.body.offsetHeight,d=i.querySelector(".tpgb-search-area").offsetHeight,y=i.querySelector(".tpgb-search-area").offsetTop+50,setTimeout(function(){d=i.querySelector(".tpgb-search-area").offsetHeight,y=i.querySelector(".tpgb-search-area").offsetTop+50},50)}var s,p,u,d,y,g=window;n(),g.addEventListener("resize",n),jQuery(g).unbind("scroll"),jQuery(g).bind("scroll",e=>{!function(e){e.preventDefault(),n(),u=g.pageYOffset||g.scrollTop;let t=i.querySelector(".tpgb-search-area");d=t.offsetHeight,y=t.offsetTop+50;var a=t.querySelector(".post-lazy-load"),e=i.querySelectorAll(".tpgb-ser-item");r.offset=e.length,r.loadNumpost=l.loadnumber,a&&u<p&&d+y-s<u+60&&(jQuery(a).data("requestRunning")||(jQuery(a).data("requestRunning",!0),jQuery.ajax({url:tpgb_config&&tpgb_config.ajax_url?tpgb_config.ajax_url:tpgb_load.ajaxUrl,method:"post",async:!0,data:r,beforeSend:function(){},success:function(e){let t=e.data.posts,a=e.data.total_count,r=null,n="";for(r in t)n+=t[r];var s;c.innerHTML+=n,i.querySelectorAll(".tpgb-ser-item").length==a&&(o.classList.add("tp-hide"),(s=o.parentNode).innerHTML+='<div class="tpgb-post-loaded">'+l.loadedtxt+"</div>",l.loadedtxt&&setTimeout(()=>{s.innerHTML=""},1e3))},complete:function(){jQuery(a).data("requestRunning",!1)}})))}(e)})}function tp_pagination_ajax(l,i,e,o){let c=o.querySelector(".tpgb-search-list-inner"),p=o.querySelectorAll(".tpgb-pagelink.tpgb-ajax-page"),u=o.querySelector(".tpgb-pagelink.next"),d=o.querySelector(".tpgb-pagelink.prev"),a=e.Pcounter||0,y=e.PClimit||3;var g=e.PNavigation||0,b=i&&i.post_page?i.post_page:3;0<p.length&&p.forEach(function(e,r){if(Number(e.dataset.page)==Number(1)){let e=o.querySelector(".tpgb-search-slider");e&&e.classList.add("ajax-"+Number(1))}else c&&(c.innerHTML+='<div class="tpgb-search-slider tpgb-row ajax-'+Number(r+1)+'"></div>');e.addEventListener("click",function(e){var t=this.dataset.page,a=t*b-b,n=100*r;i.offset=a,tp_pagination_active(p,t),g&&(d.setAttribute("data-prev",t),u.setAttribute("data-next",t));let s=c.querySelector(".tpgb-search-slider.ajax-"+t);if(s&&s.querySelector(".tpgb-ser-item"))return c.style.cssText="transform: translateX("+-n+"%)",void tp_pagination_hidden(l,o);jQuery.ajax({url:tpgb_config&&tpgb_config.ajax_url?tpgb_config.ajax_url:tpgb_load.ajaxUrl,method:"post",async:!0,data:i,beforeSend:function(){},success:function(e){let t=e.data.posts,a=null,r="";for(a in t)r+=t[a];s.innerHTML+=r,c.style.cssText="transform: translateX("+-n+"%)",tp_pagination_hidden(l,o)},complete:function(){}})})}),u&&u.addEventListener("click",function(e){var t=Number(this.dataset.next),r=t+Number(1),n=-(t*Number(100)),t=r*b-b;i.offset=t,a&&p.forEach(function(e,t){var a;r==Number(e.dataset.page)&&e.classList.contains("tp-hide")&&(a=Number(t+1-y),e.classList.remove("tp-hide"),p.forEach(function(e,t){a==t+1&&e.classList.add("tp-hide")}))}),tp_pagination_active(p,r),g&&(d.setAttribute("data-prev",r),u.setAttribute("data-next",r));let s=c.querySelector(".tpgb-search-slider.ajax-"+r);if(s&&s.querySelector(".tpgb-ser-item"))return c.style.cssText="transform: translateX("+n+"%)",void tp_pagination_hidden(l,o);jQuery.ajax({url:tpgb_config&&tpgb_config.ajax_url?tpgb_config.ajax_url:tpgb_load.ajaxUrl,method:"post",async:!0,data:i,beforeSend:function(){},success:function(e){let t=e.data.posts,a=null,r="";for(a in t)r+=t[a];s.innerHTML+=r,c.style.cssText="transform: translateX("+n+"%)",tp_pagination_hidden(l,o)},complete:function(){}})}),d&&d.addEventListener("click",function(e){var r=Number(this.dataset.prev)-Number(1),n=-100*r+100,t=r*b-b;i.offset=t,a&&p.forEach(function(e,t){var a;r==Number(e.dataset.page)&&e.classList.contains("tp-hide")&&(a=Number(t+1)+Number(y),e.classList.remove("tp-hide"),p.forEach(function(e,t){a==t+1&&e.classList.add("tp-hide")}))}),tp_pagination_active(p,r),g&&(d.setAttribute("data-prev",r),u.setAttribute("data-next",r));let s=c.querySelector(".tpgb-search-slider.ajax-"+r);if(s&&s.querySelector(".tpgb-ser-item"))return c.style.cssText="transform: translateX("+n+"%)",void tp_pagination_hidden(l,o);jQuery.ajax({url:tpgb_config&&tpgb_config.ajax_url?tpgb_config.ajax_url:tpgb_load.ajaxUrl,method:"post",async:!0,data:i,beforeSend:function(){},success:function(e){let t=e.data.posts,a=null,r="";for(a in t)r+=t[a];s.innerHTML+=r,c.style.cssText="transform: translateX("+n+"%)",tp_pagination_hidden(l,o)},complete:function(){}})})}function tp_pagination_hidden(a,r){if(a){let e=r.querySelector(".tpgb-pagelink.next"),t=r.querySelector(".tpgb-pagelink.prev");e&&(r=e.dataset&&e.dataset.next?e.dataset.next:"",parseInt(r)==a?e.style.display="none":e.style.display="inline-block"),t&&(a=t.dataset&&t.dataset.prev?t.dataset.prev:"",1==parseInt(a)?t.style.display="none":t.style.display="inline-block")}}function tp_pagination_active(e,t){0<e.length&&e.forEach(function(e){t==Number(e.dataset.page)?e.classList.add("active"):e.classList.contains("active")&&e.classList.remove("active")})}function tp_overlay_body(e){let t=e.querySelector(".tpgb-rental-overlay"),a=e.querySelector(".tpgb-input-field"),r=e.querySelector(".tpgb-search-input");r&&(r.addEventListener("focus",()=>{t.style.cssText="visibility:visible;opacity:1;",a.style.cssText="z-index:1000;"}),r.addEventListener("focusout",()=>{t.style.cssText="visibility:hidden;opacity:0;",a.style.cssText=""}));let n=e.querySelector(".tpgb-select");n&&n.addEventListener("click",()=>{t.style.cssText="visibility:visible;opacity:1;"}),t&&t.addEventListener("click",()=>{t.style.cssText="visibility:hidden;opacity:0;"}),e.addEventListener("keyup",e=>{"Escape"===e.key&&(t.style.cssText="visibility:hidden;opacity:0;")})}document.addEventListener("DOMContentLoaded",function(){let e=document.querySelectorAll(".tpgb-search-bar");e&&e.forEach(function(i){var n=i.querySelector(".tpgb-search-form"),o=i.querySelector(".tpgb-search-list-inner"),c=i.querySelector(".tpgb-search-area"),p=".tpgb-search-slider tpgb-row",u=i.querySelector(".tpgb-search-header"),s=i.dataset.ajax_search?JSON.parse(i.dataset.ajax_search):[],d=i.dataset.acfdata?JSON.parse(i.dataset.acfdata):[],y=i.dataset.genericfilter?JSON.parse(i.dataset.genericfilter):[],g=i.dataset.resultSetting?JSON.parse(i.dataset.resultSetting):[],b=i.dataset.paginationData?JSON.parse(i.dataset.paginationData):[],f=i.dataset.defaultData?JSON.parse(i.dataset.defaultData):[];o.style.transform="translateX(0)",i.querySelector(".tpgb-rental-overlay")&&tp_overlay_body(i);let e=i.querySelectorAll(".tpgb-sbar-dropdown");if(0<e.length&&e.forEach(function(e){e.addEventListener("click",function(){this.setAttribute("tabindex",1),this.classList.toggle("active");var e=this.querySelector(".tpgb-sbar-dropdown-menu");slideToggleP(e,300)}),e.addEventListener("focusout",function(){this.classList.remove("active");var e=this.querySelector(".tpgb-sbar-dropdown-menu");slideUpP(e,300)}),e.querySelectorAll(".tpgb-sbar-dropdown-menu .tpgb-searchbar-li").forEach(function(e){e.addEventListener("click",function(){var e=this.closest(".tpgb-sbar-dropdown");e.querySelector("span.search-selected-text").textContent=this.textContent,e.querySelector("input").setAttribute("value",this.getAttribute("id"));var t=new Event("change",{bubbles:!0});e.querySelector("input").dispatchEvent(t)})})}),"yes"==s.ajax){var l=f&&f.SpecialCTP?f.SpecialCTP:0,h=s&&s.ajaxsearchCharLimit?s.ajaxsearchCharLimit:0,a={action:"tpgb_search",searchData:new URLSearchParams(new FormData(n)).toString(),text:"",postper:s.post_page,GFilter:y,ACFilter:d,styleColumn:s.styleColumn,style:s.style,tempId:s.tempid,ResultData:b,DefaultData:f,resultSetting:g,nonce:s.nonce};c.querySelector(".post-load-more")&&tp_loadmore_ajax("",a,b,i),c.querySelector(".post-lazy-load")&&tp_lazymore_ajax(a,b,i);let t=c.querySelector(".tpgb-search-pagina");if(t&&""!=t.innerHTML){let e=t.getAttribute("data-pageColumn");e=e||"",tp_pagination_ajax(e,a,b,i)}n.addEventListener("keypress",function(e){var t=e.keyCode||e.which;if("Enter"===e.key||13===t)return e.stopPropagation(),e.preventDefault(),!1});var m=null;function r(e){var t=e.type,a=i.querySelector("input[name=s]")?i.querySelector("input[name=s]").value:"",r=i.querySelector("input[name=post_type]")?i.querySelector("input[name=post_type]").value:"",e=(i.querySelector("input[name=taxonomy]")&&i.querySelector("input[name=taxonomy]").value,i.querySelector("input[name=cat]")?i.querySelector("input[name=cat]").value:"");if("keyup"===t&&a&&a.length>=h||"change"===t&&(r&&0===l||r&&a&&a.length>=h||""===r&&a.length>=h||e&&0===l||e&&a&&a.length>=h||""===e&&a&&a.length>=h)){let e=i.querySelector(".tpgb-close-btn"),t=i.querySelector(".tpgb-ajx-loading"),a=i.querySelector(".tpgb-dd-icon");e&&(e.style.display="none"),i.classList.contains("tpgb-ser-input-dis")&&(a.style.display="none"),t&&(t.style.display="flex"),clearTimeout(m),m=setTimeout(function(){!function(){var e=i.querySelector("input[name=s]")?i.querySelector("input[name=s]").value:"";i.querySelector("input[name=taxonomy]")&&i.querySelector("input[name=taxonomy]").value,i.querySelector("input[name=post_type]")&&i.querySelector("input[name=post_type]").value,o.innerHTML="";let t=u.querySelector(".tpgb-search-pagina");t&&(t.innerHTML="");var l={action:"tpgb_search",searchData:new URLSearchParams(new FormData(n)).toString(),text:e,postper:s.post_page,GFilter:y,ACFilter:d,styleColumn:s.styleColumn,style:s.style,tempId:s.tempid,ResultData:b,DefaultData:f,resultSetting:g,nonce:s.nonce};jQuery.ajax({url:tpgb_config&&tpgb_config.ajax_url?tpgb_config.ajax_url:tpgb_load.ajaxUrl,method:"post",async:!0,data:l,beforeSend:function(){"pagination"==b.Pagestyle&&(i.querySelector(".tpgb-search-list-inner").style.cssText="transform: translateX(0px)")},success:function(e){let t=i.querySelectorAll(".tpgb-search-error"),a=i.querySelector(".tpgb-search-header");if(e.data.error&&0<t.length)return t[0].style.cssText="display:block",t[0].innerHTML=e.data.message,a.style.cssText="display:none",void slideDownP(c,100);t[0].style.cssText="display:none",a.style.cssText="display:flex",t[0].innerHTML="";var s=e.data||"";if(s&&0!==s.post_count){let e=s.posts,t=null,a="",r='<div class="'+p.replace(".","")+'">%s</div>',n="";for(t in slideDownP(c,100),e)n+=e[t],(parseInt(t)+1)%s.limit_query!=0&&parseInt(t)!==e.length-1||(a+=r.replace("%s",n),n="");if(o.innerHTML=a,g.TotalResult){let e=g.TotalResultTxt||"",t=u.querySelector(".tpgb-search-resultcount");t&&(t.innerHTML=s.post_count+" "+e)}if(s.pagination)i.querySelector(".tpgb-search-pagina").innerHTML=s.pagination,tp_pagination_ajax(s.columns||"",l,b,i);else if(null!=s.loadmore){let e=i.querySelector(".tpgb-load-more");if(s.loadmore)if(s.limit_query<s.total_count)e.innerHTML=s.loadmore,tp_loadmore_ajax(s,l,b,i);else{let e=i.querySelectorAll(".tpgb-search-pagina");0<e.length&&(e[0].innerHTML=s.loadmore_page)}else e.innerHTML=""}else if(s.lazymore){let e=i.querySelector(".tpgb-lazy-load");s.limit_query<s.total_count?(e.innerHTML=s.lazymore,tp_lazymore_ajax(l,b,i)):e.innerHTML=""}}else t[0].style.cssText="display:block",t[0].innerHTML=g.errormsg,a.style.cssText="display:none",slideDownP(c,100)},complete:function(){let e=document.querySelectorAll(".tpgb-search-input");0<e.length&&e.forEach(e=>{setTimeout(function(){e.blur()},500)})}}).then(function(e){setTimeout(function(){var e=i.querySelector(".tpgb-close-btn"),t=i.querySelector(".tpgb-ajx-loading");t&&(t.style.cssText="display:none"),e&&(e.style.cssText="display:flex")},500),function(){let t=i.querySelector(".tpgb-search-area"),a=i.querySelector("input[name=s]"),r=i.querySelector(".tpgb-rental-overlay"),n=i.querySelector(".tpgb-close-btn"),s=i.querySelector(".tpgb-dd-icon");n&&n.addEventListener("click",e=>{a&&(a.value=""),e.currentTarget.style.display="none",slideUpP(t),r&&(r.style.cssText="visibility:hidden;opacity:0;"),i.classList.contains("tpgb-ser-input-dis")&&(s.style.cssText="display:flex")}),i.addEventListener("keyup",e=>{"Escape"===e.key&&(a.value="",slideUpP(t),n.style.cssText="display:none")})}()})}()},400)}}i.addEventListener("change",r),i.addEventListener("keyup",r)}})});